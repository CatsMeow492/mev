(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[746],{2067:e=>{"use strict";e.exports=require("node:async_hooks")},6195:e=>{"use strict";e.exports=require("node:buffer")},4868:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ComponentMod:()=>_,default:()=>x});var s={};r.r(s),r.d(s,{DELETE:()=>E,GET:()=>d,OPTIONS:()=>T,POST:()=>h,PUT:()=>p,runtime:()=>c});var a={};r.r(a),r.d(a,{originalPathname:()=>C,patchFetch:()=>S,requestAsyncStorage:()=>A,routeModule:()=>f,serverHooks:()=>P,staticGenerationAsyncStorage:()=>m});var o=r(932),n=r(2561),i=r(4828),u=r(6631),l=r(9985);let c="edge";async function d(e){return g(e,"GET")}async function h(e){return g(e,"POST")}async function p(e){return g(e,"PUT")}async function E(e){return g(e,"DELETE")}async function T(e){let t=new Headers;return t.set("Access-Control-Allow-Origin","*"),t.set("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),t.set("Access-Control-Allow-Headers","Content-Type, Authorization, X-Requested-With"),t.set("Access-Control-Max-Age","86400"),new Response(null,{status:200,headers:t})}async function g(e,t){try{let r;let{searchParams:s,pathname:a}=new URL(e.url),o=s.get("path")||"",n=function(e){let t="http://localhost:8080",r=process.env.NEXT_PUBLIC_STRATEGY_SERVICE_URL||t,s=process.env.NEXT_PUBLIC_REPLAY_SERVICE_URL||t,a=process.env.NEXT_PUBLIC_FORK_SERVICE_URL||t;return e.startsWith("strategy/")?r:e.startsWith("replay/")?s:e.startsWith("fork/")?a:(e.startsWith("health")||e.startsWith("api/"),t)}(o);if(!n)return l.xk.json({error:"Invalid service path"},{status:400});let i=await w(e,o);if(i.error)return l.xk.json({error:i.error},{status:i.status||401});let u=await y(e);if(u.error)return l.xk.json({error:u.error},{status:429,headers:{"Retry-After":"60","X-RateLimit-Limit":"100","X-RateLimit-Remaining":"0","X-RateLimit-Reset":Math.floor(Date.now()/1e3+60).toString()}});let c=new Headers;c.set("Content-Type",e.headers.get("Content-Type")||"application/json"),c.set("User-Agent","MEV-Dashboard-Proxy/1.0"),c.set("X-Forwarded-For",e.headers.get("X-Forwarded-For")||"unknown"),c.set("X-Request-ID",R());let d=e.headers.get("Authorization");if(d&&c.set("Authorization",d),"POST"===t||"PUT"===t)try{r=await e.text()}catch(e){r=void 0}let h=await fetch(`${n}/${o}`,{method:t,headers:c,body:r,signal:AbortSignal.timeout(3e4)}),p=new Headers;p.set("Access-Control-Allow-Origin","*"),p.set("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),p.set("Access-Control-Allow-Headers","Content-Type, Authorization, X-Requested-With"),["Content-Type","Cache-Control","X-RateLimit-Limit","X-RateLimit-Remaining","X-RateLimit-Reset"].forEach(e=>{let t=h.headers.get(e);t&&p.set(e,t)}),p.set("X-Proxy-Timestamp",new Date().toISOString()),p.set("X-Response-Time",Date.now().toString());let E=await h.text();return new Response(E,{status:h.status,statusText:h.statusText,headers:p})}catch(e){return console.error("Proxy request failed:",e),l.xk.json({error:"Backend service unavailable",timestamp:new Date().toISOString(),requestId:R()},{status:503,headers:{"Access-Control-Allow-Origin":"*","Retry-After":"30"}})}}async function w(e,t){if(["health","api/health","api/status"].some(e=>t.startsWith(e)))return{};let r=e.headers.get("Authorization");return r?r.startsWith("Bearer ")?r.slice(7).length<10?{error:"Invalid token",status:401}:{}:{error:"Invalid authorization header format",status:401}:(console.warn("Request without authentication:",t),{})}async function y(e){let t=e.headers.get("X-Forwarded-For");return t?.split(",")[0],{}}function R(){return`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}let f=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/edge/proxy/route",pathname:"/api/edge/proxy",filename:"route",bundlePath:"app/api/edge/proxy/route"},resolvedPagePath:"/Users/taylormohney/Documents/GitHub/MEVDemo/web/dashboard/src/app/api/edge/proxy/route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:A,staticGenerationAsyncStorage:m,serverHooks:P}=f,C="/api/edge/proxy/route";function S(){return(0,u.XH)({serverHooks:P,staticGenerationAsyncStorage:m})}let _=a,x=o.a.wrap(f)}},e=>{var t=t=>e(e.s=t);e.O(0,[520],()=>t(4868));var r=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/edge/proxy/route"]=r}]);
//# sourceMappingURL=route.js.map